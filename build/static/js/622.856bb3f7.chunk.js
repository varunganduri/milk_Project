"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[622],{4220:(e,s,t)=>{t.d(s,{A:()=>n});t(5043);var a=t(579);const n=()=>(0,a.jsx)("div",{className:"dot-spinner",children:Array.from({length:8},((e,s)=>(0,a.jsx)("div",{className:`dot-spinner__dot dot-spinner__dot--${s+1}`},s)))})},9622:(e,s,t)=>{t.r(s),t.d(s,{default:()=>l});var a=t(5043),n=t(3216),i=t(4220),r=t(579);const l=()=>{const[e,s]=(0,a.useState)([]),[t,l]=(0,a.useState)([]),[c,o]=(0,a.useState)({mobile_number:""}),[d,u]=(0,a.useState)(null),[p,m]=(0,a.useState)(""),[h,j]=(0,a.useState)(!1),[x,g]=(0,a.useState)([]),[v,N]=(0,a.useState)(!1),[y,b]=(0,a.useState)(!1),f=(0,a.useRef)(null),k=(0,n.Zp)(),[S,w]=(0,a.useState)("");(0,a.useEffect)((()=>{const e=e=>{f.current&&!f.current.contains(e.target)&&j(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[f]),(0,a.useEffect)((()=>{const e=localStorage.getItem("authToken");if(!e)return void k("/login");(async()=>{N(!0);try{const t=await fetch("https://prasad-gz5p.onrender.com/api/get-suppliers/",{headers:{Authorization:`Token ${e}`}});if(!t.ok)throw new Error("Failed to fetch supplier data");const a=(await t.json()).suppliers||[];s(a),l(a)}catch(d){u(d.message)}finally{N(!1)}})()}),[k]),(0,a.useEffect)((()=>{const s=e.filter((e=>e.includes(p)));l(s)}),[p,e]);if(d)return(0,r.jsxs)("div",{className:"error-message",children:["Error: ",d]});const _=(e,s)=>{const t=document.getElementById(`quantity-${e}`);let a=parseInt(t.value)||1;a+=s,a<1&&(a=1),t.value=a};return(0,r.jsxs)("div",{className:"supplier-home21",children:[d&&(0,r.jsx)("p",{className:"error-message21",children:d}),S&&(0,r.jsx)("div",{className:"snackbar show",children:S}),(0,r.jsx)("h2",{className:"sup-head",children:"Suppliers"}),(0,r.jsxs)("div",{className:"supplier-section21",children:[(0,r.jsxs)("div",{className:"dropdown21",ref:f,children:[(0,r.jsxs)("button",{onClick:()=>j(!h),className:"dropdown-toggle21",children:[c.mobile_number?`${c.mobile_number}`:"Select a Supplier",c.name&&(0,r.jsx)("span",{className:"crossmark21",onClick:e=>{e.stopPropagation(),o({mobile_number:""}),g([])},children:"\xd7"})]}),h&&(0,r.jsxs)("div",{className:"dropdown-menu21",children:[(0,r.jsx)("input",{type:"text",placeholder:"Search by name or mobile number",value:p,onChange:e=>m(e.target.value),className:"search-input21"}),(0,r.jsx)("div",{className:"supplier-list-container21",children:v?(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"10vh"},children:(0,r.jsx)("div",{className:"loader21",children:"Loading Suppliers..."})}):(0,r.jsx)("ul",{className:"supplier-list21",children:t.length?t.map(((e,s)=>(0,r.jsx)("li",{onClick:()=>(e=>{o({mobile_number:e}),j(!1)})(e),children:e},s))):(0,r.jsx)("p",{className:"no-suppliers21",children:"No suppliers found"})})})]})]}),(0,r.jsx)("button",{onClick:async()=>{const e=localStorage.getItem("authToken"),s={supplier_mobile_number:c.mobile_number};try{if(!(await fetch("https://prasad-gz5p.onrender.com/api/select-supplier/",{method:"POST",headers:{Authorization:`Token ${e}`,"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)return w("Please Select supplier."),void setTimeout((()=>w("")),3e3);w("Supplier details submitted successfully!"),setTimeout((()=>w("")),3e3),await(async e=>{const s=localStorage.getItem("authToken");b(!0);try{const t=await fetch(`https://prasad-gz5p.onrender.com/api/productslist/?supplier=${e}`,{headers:{Authorization:`Token ${s}`}});if(!t.ok)throw new Error("Failed to fetch products");const a=await t.json();g(a.products)}catch(d){u(d.message)}finally{b(!1)}})(c.supplier)}catch(d){u(d.message)}},className:"btn-submit21",children:"Submit Supplier"})]}),!c.mobile_number&&(0,r.jsx)("div",{className:"n0-selected21",children:(0,r.jsx)("p",{children:"No Supplier Selected"})}),y?(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:(0,r.jsx)(i.A,{})}):x.length>0&&(0,r.jsx)("div",{className:"product-card-container21",children:x.map(((e,s)=>(0,r.jsxs)("div",{className:"card21",children:[(0,r.jsx)("div",{className:"image_container21",children:(0,r.jsx)("img",{src:e.image_url,alt:e.description,className:"image21"})}),(0,r.jsxs)("div",{className:"bottom-section21",children:[(0,r.jsx)("div",{className:"title21",children:(0,r.jsx)("p",{children:(0,r.jsx)("span",{children:e.category})})}),(0,r.jsx)("div",{className:"description21",children:(0,r.jsx)("p",{children:e.description})}),(0,r.jsx)("div",{className:"volume21",children:(0,r.jsxs)("span",{className:"qty",children:["Volume: ",(0,r.jsx)("span",{className:"volume-value21",children:e.volume})]})}),(0,r.jsxs)("div",{className:"quantity21",children:[(0,r.jsx)("span",{className:"qty",children:"Quantity"}),(0,r.jsx)("button",{className:"volume-button21",onClick:()=>_(e.id,-1),children:"-"}),(0,r.jsx)("input",{type:"number",min:"1",defaultValue:"1",className:"inputBox21",id:`quantity-${e.id}`}),(0,r.jsx)("button",{className:"volume-button21",onClick:()=>_(e.id,1),children:"+"})]}),(0,r.jsxs)("div",{className:"action21",children:[(0,r.jsx)("div",{className:"price21",children:(0,r.jsxs)("span",{children:["\u20b9",e.Final_Price]})}),(0,r.jsxs)("button",{className:"cart-button21",onClick:()=>{const s=parseInt(document.getElementById(`quantity-${e.id}`).value)||1;(async(e,s,t)=>{console.log("Adding to cart:",{product_id:e,quantity:s,price:t});const a=parseInt(t),n=localStorage.getItem("authToken"),i={product_id:e,quantity:s,price:a};try{const s=await fetch(`https://prasad-gz5p.onrender.com/api/add-to-cart/${e}/`,{method:"POST",headers:{Authorization:`Token ${n}`,"Content-Type":"application/json"},body:JSON.stringify(i)});if(!s.ok)throw new Error(`Failed to add to cart: ${s.statusText}`);w("Product added to cart successfully!"),setTimeout((()=>w("")),3e3)}catch(d){alert("Error: "+d.message)}})(e.id,s,e.Final_Price)},children:[(0,r.jsx)("svg",{className:"cart-icon21",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z",strokeLinejoin:"round",strokeLinecap:"round"})}),(0,r.jsx)("span",{children:"Add to cart"})]})]})]})]},s)))})]})}}}]);
//# sourceMappingURL=622.856bb3f7.chunk.js.map