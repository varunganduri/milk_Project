"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[407],{8891:(e,s,t)=>{t.d(s,{A:()=>n});t(5043);var a=t(579);const n=()=>(0,a.jsx)("div",{className:"dot-spinnerb26",children:Array.from({length:8},((e,s)=>(0,a.jsx)("div",{className:`dot-spinner__dotb26 dot-spinner__dotb26--${s+1}`},s)))})},5407:(e,s,t)=>{t.r(s),t.d(s,{default:()=>l});var a=t(5043),n=t(3216),i=t(8891),r=t(579);const l=()=>{const[e,s]=(0,a.useState)([]),[t,l]=(0,a.useState)([]),[c,o]=(0,a.useState)({mobile_number:""}),[d,u]=(0,a.useState)(null),[p,m]=(0,a.useState)(""),[h,b]=(0,a.useState)(!1),[j,x]=(0,a.useState)([]),[g,v]=(0,a.useState)(!1),[N,y]=(0,a.useState)(!1),z=(0,a.useRef)(null),f=(0,n.Zp)(),[k,S]=(0,a.useState)("");(0,a.useEffect)((()=>{const e=e=>{z.current&&!z.current.contains(e.target)&&b(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[z]),(0,a.useEffect)((()=>{const e=localStorage.getItem("authToken");if(!e)return void f("/login");(async()=>{v(!0);try{const t=await fetch("https://prasad-gz5p.onrender.com/api/get-suppliers/",{headers:{Authorization:`Token ${e}`}});if(!t.ok)throw new Error("Failed to fetch supplier data");const a=(await t.json()).suppliers||[];s(a),l(a)}catch(d){u(d.message)}finally{v(!1)}})()}),[f]),(0,a.useEffect)((()=>{const s=e.filter((e=>e.includes(p)));l(s)}),[p,e]);if(d)return(0,r.jsxs)("div",{className:"error-message",children:["Error: ",d]});const w=(e,s)=>{const t=document.getElementById(`quantity-${e}`);let a=parseInt(t.value)||1;a+=s,a<1&&(a=1),t.value=a};return(0,r.jsxs)("div",{className:"supplier-homebsz84",children:[d&&(0,r.jsx)("p",{className:"error-messagebsz84",children:d}),k&&(0,r.jsx)("div",{className:"snackbar show",children:k}),(0,r.jsx)("h2",{className:"sup-headbsz84",children:"Suppliers"}),(0,r.jsxs)("div",{className:"supplier-sectionbsz84",children:[(0,r.jsxs)("div",{className:"dropdownbsz84",ref:z,children:[(0,r.jsxs)("button",{onClick:()=>b(!h),className:"dropdown-togglebsz84",children:[c.mobile_number?`${c.mobile_number}`:"Select a Supplier",c.mobile_number&&(0,r.jsx)("span",{className:"crossmarkbsz84",onClick:e=>{e.stopPropagation(),o({mobile_number:""}),x([])},children:"\xd7"})]}),h&&(0,r.jsxs)("div",{className:"dropdown-menubsz84",children:[(0,r.jsx)("input",{type:"text",placeholder:"Search by name or mobile number",value:p,onChange:e=>m(e.target.value),className:"search-inputbsz84"}),(0,r.jsx)("div",{className:"supplier-list-container21",children:g?(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"10vh"},children:(0,r.jsx)("div",{className:"loaderbsz84",children:"Loading Suppliers..."})}):(0,r.jsx)("ul",{className:"supplier-listbsz84",children:t.length?t.map(((e,s)=>(0,r.jsx)("li",{onClick:()=>(e=>{o({mobile_number:e}),b(!1)})(e),children:e},s))):(0,r.jsx)("p",{className:"no-suppliersbsz84",children:"No suppliers found"})})})]})]}),(0,r.jsx)("button",{onClick:async()=>{const e=localStorage.getItem("authToken"),s={supplier_mobile_number:c.mobile_number};try{if(!(await fetch("https://prasad-gz5p.onrender.com/api/select-supplier/",{method:"POST",headers:{Authorization:`Token ${e}`,"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)return S("Please Select supplier."),void setTimeout((()=>S("")),3e3);S("Supplier details submitted successfully!"),setTimeout((()=>S("")),3e3),await(async e=>{const s=localStorage.getItem("authToken");y(!0);try{const t=await fetch(`https://prasad-gz5p.onrender.com/api/productslist/?supplier=${e}`,{headers:{Authorization:`Token ${s}`}});if(!t.ok)throw new Error("Failed to fetch products");const a=await t.json();x(a.products)}catch(d){u(d.message)}finally{y(!1)}})(c.supplier)}catch(d){u(d.message)}},className:"btn-submitbsz84",children:"Submit Supplier"})]}),!c.mobile_number&&(0,r.jsx)("div",{className:"n0-selectedbsz84",children:(0,r.jsx)("p",{children:"No Supplier Selected"})}),N?(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:(0,r.jsx)(i.A,{})}):j.length>0&&(0,r.jsx)("div",{className:"product-card-containerbsz84",children:j.map(((e,s)=>(0,r.jsxs)("div",{className:"cardbsz84",children:[(0,r.jsx)("div",{className:"image_containerbsz84",children:(0,r.jsx)("img",{src:e.image_url,alt:e.description,className:"imagebsz84"})}),(0,r.jsxs)("div",{className:"bottom-sectionbsz84",children:[(0,r.jsx)("div",{className:"titlebsz84",children:(0,r.jsx)("p",{children:(0,r.jsx)("span",{children:e.category})})}),(0,r.jsx)("div",{className:"descriptionbsz84",children:(0,r.jsx)("p",{children:e.description})}),(0,r.jsx)("div",{className:"volumebsz84",children:(0,r.jsxs)("span",{className:"qty",children:["Volume: ",(0,r.jsx)("span",{className:"volume-valuebsz84",children:e.volume})]})}),(0,r.jsxs)("div",{className:"quantitybsz84",children:[(0,r.jsx)("span",{className:"qty",children:"Quantity"}),(0,r.jsx)("button",{className:"volume-buttonbsz84",onClick:()=>w(e.id,-1),children:"-"}),(0,r.jsx)("input",{type:"number",min:"1",defaultValue:"1",className:"inputBoxbsz84",id:`quantity-${e.id}`}),(0,r.jsx)("button",{className:"volume-buttonbsz84",onClick:()=>w(e.id,1),children:"+"})]}),(0,r.jsxs)("div",{className:"actionbsz84",children:[(0,r.jsx)("div",{className:"pricebsz84",children:(0,r.jsxs)("span",{children:["\u20b9",e.Final_Price]})}),(0,r.jsxs)("button",{className:"cart-buttonbsz84",onClick:()=>{const s=parseInt(document.getElementById(`quantity-${e.id}`).value)||1;(async(e,s,t)=>{console.log("Adding to cart:",{product_id:e,quantity:s,price:t});const a=parseInt(t),n=localStorage.getItem("authToken"),i={product_id:e,quantity:s,price:a};try{const s=await fetch(`https://prasad-gz5p.onrender.com/api/add-to-cart/${e}/`,{method:"POST",headers:{Authorization:`Token ${n}`,"Content-Type":"application/json"},body:JSON.stringify(i)});if(!s.ok)throw new Error(`Failed to add to cart: ${s.statusText}`);S("Product added to cart successfully!"),setTimeout((()=>S("")),3e3)}catch(d){alert("Error: "+d.message)}})(e.id,s,e.Final_Price)},children:[(0,r.jsx)("svg",{className:"cart-iconbsz84",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z",strokeLinejoin:"round",strokeLinecap:"round"})}),(0,r.jsx)("span",{children:"Add to cart"})]})]})]})]},s)))})]})}}}]);
//# sourceMappingURL=407.7b6f8c7e.chunk.js.map